<%= render :partial => "menu" %>

<% if @event %>

  <h2>
    Enkätstatistik för <%= @event.name -%>
  </h2>
  <p>
    <%=link_to "Ladda ner enkätstatistik för #{@event.name} som Excel-fil", :event_id => @event,  :format => "xls" %>
  </p>
  <p>
    Antal besvarade enkäter: <%= @event.questionnaire.answer_forms.count(:all,:conditions => { :completed => true }) -%>
    Antal obesvarade enkäter: <%= @event.questionnaire.answer_forms.count(:all,:conditions => { :completed => false }) -%> 
  </p>
  <table>
    <thead>
      <tr>
        <th>Fråga</th>
        <th>Svarsstatistik</th>
      </tr>
    </thead>
    <tbody>
      <% @event.questionnaire.questions.each do |question| %>
        <tr class="<%= cycle("", "even") %>">
          <td>
            <%= question.question -%>
          </td>
          <td>
            <%= question_statistics(question, question.statistics_for_event(@event)) %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>


<% else %>

  <h2>
    Enkätstatistik <%= @term %>
  </h2>

  <h3>Evenemangsspecifik statistik</h3>
  <table>
    <thead>
      <tr>
        <th>Evenemang</th>
        <th>Arrangör</th>
      </tr>
    </thead>
    <tbody>
      <% @events.each do |event| %>
        <tr class="<%= cycle("", "even") %>">
          <td>
            <%= link_to event.name, questionnaires_event_statistic_path(event, @term) -%>
          </td>
          <td>
            <%= event.culture_provider.name %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

<% end %>
