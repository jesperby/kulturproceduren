<%= render :partial => "menu" %>

<% iday = @cal_sday.clone %>

<table class="calendar-table">
  <thead>
    <tr class="calendar-month-nav">
      <th class="prev" colspan="2">
        <a href="<%= url_for :overwrite_params => { :month => @prevmonth.month , :year => @prevmonth.year } %>"><%= month_name(@prevmonth.month)%></a>
      </th>
      <th class="current" colspan="3"><%= month_name(@dispmonth) %></th>
      <th class="next" colspan="2">
        <a href="<%= url_for :overwrite_params => { :month => @nextmonth.month , :year => @nextmonth.year } %>"><%= month_name(@nextmonth.month)%></a>
      </th>
    </tr>
    <tr class="calendar-day-headers">
      <th>Mån</th>
      <th>Tis</th>
      <th>Ons</th>
      <th>Tor</th>
      <th>Fre</th>
      <th>Lör</th>
      <th>Sön</th>
    </tr>
  </thead>

  <tbody>

    <% puts "DEBUG FROM VIEW: #{iday.to_s} , #{@nextmonth.to_s}" %>
    <% while ( iday < @nextmonth ) do %>

        <tr>
          <% (1..7).each do |n|
            iday = iday + 1 -%>
            <td class="<%= "inactive" unless iday.month == @dispmonth.month %>">

              <%= iday.day %>
              
              <% if ! @oh[iday].nil? %>
                <div class="calendar-table-eventname">
                  <a href="<%= events_path(@oh[iday].event_id) %>"><%= Event.find_by_id(@oh[iday].event_id).name %></a>
                </div>
                <div class="calendar-table-occasion">
                  <a href="<%= url_for :controller => "booking", :action => "book", :occasion_id => @oh[iday].id %>">BOKA</a>
                </div>
              <% end %>
            </td>
          <% end %>
        </tr>

      <% end %>
    </tbody>
  </table>